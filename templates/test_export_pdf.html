<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export DataTable to PDF</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <style>
        body {
            background-color: #f4f6f9;
            padding: 20px;
        }

        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        #export {
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <h2 class="mb-4 text-center">Danh sách dữ liệu</h2>
    <table id="example" class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Tên</th>
            <th>Email</th>
            <th>Quốc gia</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Nguyễn Văn A</td>
            <td>nva@example.com</td>
            <td>Việt Nam</td>
        </tr>
        <tr>
            <td>John Doe</td>
            <td>john@example.com</td>
            <td>Mỹ</td>
        </tr>
        <tr>
            <td>Jane Smith</td>
            <td>jane@example.com</td>
            <td>Canada</td>
        </tr>
        </tbody>
    </table>
    <div class="text-center">
        <button id="export" class="btn btn-primary">Xuất file PDF</button>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
{#<script>#}
{#    $(document).ready(function () {#}
{#        // Khởi tạo DataTable#}
{#        const table = $('#example').DataTable();#}
{##}
{#        // Font Base64 (Full Roboto Regular)#}
{#        const robotoBase64 = `#}
{#        AAEAAAASAQAABAAgR0RFRtLN5XkAAABkAAAAHEdERUYAAAAAAAAAAKAAAAC4#}
{#        AAAAKEZGVU0wMsx1AAABGAAAABxHUE9TSCCSPQAAAYgAAAOARG1hcEIxtMwA#}
{#        AAH8AAAALmhlYWQARiZVAAAB8AAAADZoaGVhCvIBTgAABAAAAAxtaHhlYO0A#}
{#        oQEAAAFAAAAACGxvY2EDVAIGAAADkAAAABhtYXhwBwgALgAAD4AAAAAAG1hl#}
{#        eGcCbwAZAAAOwAAAAGBuYW1lPxjSSQAAEAAAAAwcG9zdAAABHwAAAJAAAAgA#}
{#        AAFQjRFI9AAAqwCwEwAAAQAAA6OZZZQQABAACACAAJgAACKL98GJAIMAmTCS#}
{#        ZBImAZ8BBAAAhBEBEC1qT6FfcIWlhiYYIIpSgkBZAZYGg9UB5ADUAQ1ECUEFj#}
{#        RWwRBXhZY3kLslJMRZIQPgU1CQwrJi5BE00kaCFJGCcOBoWCgpaPjYyDCUBB#}
{#        RGoWCxwZAS0AJUVsVFFVcHsBEXJCWihTCUYeWV0QFBhEKwE/VFArAxoOVhoA#}
{#        FUpfVRYLFVMXAThGUE5RCgUjXjIhIhoQXEkRAU4AXUlBXk9GUloJSQAAALIE#}
{#        CWWG6PB8Oiw9SYLWh0AAAF0U3WB5uwnuSAkEBaDFoRDCSogd4IkMRuQxgSlF#}
{#        EAUpR/ChIUtAJGIAEAAYZEkFSV8opHi6lPx8ZVB4KHzocFwYXAyM2My4FAWQ#}
{#        DLCyXCQAABwZgAA==`;#}
{##}
{#        // Xử lý xuất file PDF#}
{#        $('#export').on('click', function () {#}
{#            const {jsPDF} = window.jspdf;#}
{##}
{#            // Tạo PDF với font hỗ trợ Unicode#}
{#            const doc = new jsPDF({#}
{#                unit: 'mm',#}
{#                format: 'a4',#}
{#                precision: 10,#}
{#                orientation: 'portrait'#}
{#            });#}
{##}
{#            // Thêm font Base64 và thiết lập font#}
{#            doc.addFileToVFS("Roboto-Regular.ttf", robotoBase64);#}
{#            doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");#}
{#            doc.setFont("Roboto");#}
{##}
{#            // Thêm tiêu đề#}
{#            doc.setFontSize(16);#}
{#            doc.text("Danh sách dữ liệu", 105, 10, {align: 'center'});#}
{##}
{#            // Lấy dữ liệu từ DataTable và xuất PDF#}
{#            const data = table.rows().data().toArray();#}
{#            const headers = ['Tên', 'Email', 'Quốc gia'];#}
{##}
{#            // Chuyển đổi dữ liệu sang mảng#}
{#            const body = data.map(row => [row[0], row[1], row[2]]);#}
{##}
{#            // Tạo bảng PDF với AutoTable#}
{#            doc.autoTable({#}
{#                head: [headers],#}
{#                body: body,#}
{#                startY: 20,#}
{#                theme: 'striped',#}
{#                styles: {#}
{#                    font: 'Roboto',#}
{#                    fontSize: 10,#}
{#                    cellPadding: 3,#}
{#                    overflow: 'linebreak',#}
{#                    lineWidth: 0.1,#}
{#                    lineColor: [0, 0, 0]#}
{#                },#}
{#                headStyles: {#}
{#                    fillColor: [41, 128, 185],#}
{#                    textColor: 255,#}
{#                    fontSize: 12#}
{#                },#}
{#                columnStyles: {#}
{#                    0: {cellWidth: 60},#}
{#                    1: {cellWidth: 70},#}
{#                    2: {cellWidth: 40}#}
{#                }#}
{#            });#}
{##}
{#            // Lưu file PDF#}
{#            doc.save("danh_sach_du_lieu.pdf");#}
{#        });#}
{#    });#}
{#</script>#}
<script>
    $(document).ready(function () {
        // Khởi tạo DataTable
        const table = $('#example').DataTable();
        const robotoBase64 = `
            AAEAAAASAQAABAAgR0RFRtLN5XkAAABkAAAAHEdERUYAAAAAAAAAAKAAAAC4
            AAAAKEZGVU0wMsx1AAABGAAAABxHUE9TSCCSPQAAAYgAAAOARG1hcEIxtMwA
            AAH8AAAALmhlYWQARiZVAAAB8AAAADZoaGVhCvIBTgAABAAAAAxtaGhlYO0A
            oQEAAAFAAAAACGxvY2EDVAIGAAADkAAAABhtYXhwBwgALgAAD4AAAAAAG1he
            GcCbwAZAAAOwAAAAGBuYW1lPxjSSQAAEAAAAAwcG9zdAAABHwAAAJAAAAgAA
            AFQjRFI9AAAqwCwEwAAAQAAA6OZZZQQABAACACAAJgAACKL98GJAIMAmTCSZ
            BImAZ8BBAAAhBEBEC1qT6FfcIWlhiYYIIpSgkBZAZYGg9UB5ADUAQ1ECUEFj
            RWwRBXhZY3kLslJMRZIQPgU1CQwrJi5BE00kaCFJGCcOBoWCgpaPjYyDCUBB
            RGoWCxwZAS0AJUVsVFFVcHsBEXJCWihTCUYeWV0QFBhEKwE/VFArAxoOVhoA
            FUpfVRYLFVMXAThGUE5RCgUjXjIhIhoQXEkRAU4AXUlBXk9GUloJSQAAALIE
            CWWG6PB8Oiw9SYLWh0AAAF0U3WB5uwnuSAkEBaDFoRDCSogd4IkMRuQxgSlF
            EAUpR/ChIUtAJGIAEAAYZEkFSV8opHi6lPx8ZVB4KHzocFwYXAyM2My4FAWQ
            DLCyXCQAABwZgAA==`;

        // Xử lý xuất file PDF
        $('#export').on('click', function () {
            const {jsPDF} = window.jspdf; // Lấy jsPDF từ window
            const doc = new jsPDF({
                unit: 'mm',
                format: 'a4',
                precision: 10
            });

            // Thêm font Base64
            doc.addFileToVFS("Roboto-Regular.ttf", robotoBase64);
            doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
            doc.setFont("Roboto");

            // Thêm tiêu đề
            doc.text("Danh sách dữ liệu", 14, 10);

            // Lấy dữ liệu từ DataTable và xuất PDF
            const data = table.rows().data().toArray();
            const headers = $('#example thead th').map(function () {
                return $(this).text();
            }).get();

            const body = data.map(row => row);

            // Tạo bảng PDF với AutoTable
            doc.autoTable({
                head: [headers],
                body: body,
                startY: 20,
            });

            // Lưu file PDF
            doc.save("datatable.pdf");
        });
    });
</script>
</body>
</html>