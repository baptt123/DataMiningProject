{#{% extends "layout.html" %}#}
{#<!DOCTYPE html>#}
{#<html>#}
{#<head>#}
{#    <title>Xuất báo cáo PDF</title>#}
{#    <meta charset="UTF-8">#}
{#    <!-- DataTables CSS -->#}
{#    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">#}
{#    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">#}
{#    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">#}
{##}
{#    <style>#}
{#        body {#}
{#            font-family: Arial, sans-serif;#}
{#            margin: 20px;#}
{#            background-color: #f5f5f5;#}
{#        }#}
{#        .container {#}
{#            max-width: 1400px;#}
{#            margin: 0 auto;#}
{#            background-color: white;#}
{#            padding: 20px;#}
{#            border-radius: 8px;#}
{#            box-shadow: 0 0 10px rgba(0,0,0,0.1);#}
{#        }#}
{#        .header {#}
{#            text-align: center;#}
{#            margin-bottom: 30px;#}
{#        }#}
{#        .export-button {#}
{#            display: inline-block;#}
{#            padding: 12px 24px;#}
{#            background-color: #4CAF50;#}
{#            color: white !important;#}
{#            text-decoration: none;#}
{#            border-radius: 4px;#}
{#            margin-bottom: 20px;#}
{#        }#}
{#        .export-button:hover {#}
{#            background-color: #45a049;#}
{#            text-decoration: none;#}
{#        }#}
{#        .status {#}
{#            padding: 4px 8px;#}
{#            border-radius: 4px;#}
{#            font-weight: 500;#}
{#        }#}
{#        .status-positive {#}
{#            background-color: #ffebee;#}
{#            color: #c62828;#}
{#        }#}
{#        .status-negative {#}
{#            background-color: #e8f5e9;#}
{#            color: #2e7d32;#}
{#        }#}
{#        .dt-buttons {#}
{#            margin-bottom: 15px;#}
{#        }#}
{#        .dataTables_filter {#}
{#            margin-bottom: 15px;#}
{#        }#}
{#    </style>#}
{#</head>#}
{#<body>#}
{#    <div class="container">#}
{#        <div class="header">#}
{#            <h1>Dữ liệu bệnh nhân</h1>#}
{#            <a href="{{ url_for('test_export_pdf') }}" class="export-button">#}
{#                Tải xuống PDF#}
{#            </a>#}
{#        </div>#}
{##}
{#        <div class="table-responsive">#}
{#            <table id="patientTable" class="table table-striped table-bordered">#}
{#                <thead>#}
{#                    <tr>#}
{#                        <th>ID</th>#}
{#                        <th>Tuổi</th>#}
{#                        <th>Giới tính</th>#}
{#                        <th>Loại đau ngực</th>#}
{#                        <th>Huyết áp</th>#}
{#                        <th>Cholesterol</th>#}
{#                        <th>Nhịp tim tối đa</th>#}
{#                        <th>Đau thắt ngực</th>#}
{#                        <th>Đường huyết</th>#}
{#                        <th>Chẩn đoán</th>#}
{#                    </tr>#}
{#                </thead>#}
{#                <tbody>#}
{#                    {% for row in data %}#}
{#                    <tr>#}
{#                        <td>{{ row[0] }}</td>#}
{#                        <td>{{ row[1] }}</td>#}
{#                        <td>{{ row[2] }}</td>#}
{#                        <td>{{ row[3] }}</td>#}
{#                        <td>{{ row[4] }}</td>#}
{#                        <td>{{ row[5] }}</td>#}
{#                        <td>{{ row[6] }}</td>#}
{#                        <td>{{ row[7] }}</td>#}
{#                        <td>{{ row[8] }}</td>#}
{#                        <td>#}
{#                            <span class="status {% if 'Có bệnh' in row[9] %}status-positive{% else %}status-negative{% endif %}">#}
{#                                {{ row[9] }}#}
{#                            </span>#}
{#                        </td>#}
{#                    </tr>#}
{#                    {% endfor %}#}
{#                </tbody>#}
{#            </table>#}
{#        </div>#}
{#    </div>#}
{##}
{#    <!-- JavaScript -->#}
{#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>#}
{#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>#}
{##}
{#    <script>#}
{#        $(document).ready(function() {#}
{#            $('#patientTable').DataTable({#}
{#                dom: 'Bfrtip',#}
{#                buttons: [#}
{#                    'copy', 'csv', 'excel', 'print'#}
{#                ],#}
{#                language: {#}
{#                    url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/vi.json'#}
{#                },#}
{#                pageLength: 10,#}
{#                lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "Tất cả"]],#}
{#                order: [[0, 'asc']],#}
{#                responsive: true,#}
{#                initComplete: function () {#}
{#                    // Thêm bộ lọc cho các cột#}
{#                    this.api().columns().every(function () {#}
{#                        var column = this;#}
{#                        var title = column.header().textContent;#}
{##}
{#                        // Tạo input cho tìm kiếm#}
{#                        var input = $('<input type="text" class="form-control form-control-sm" placeholder="Tìm ' + title + '" />')#}
{#                            .appendTo($(column.header()))#}
{#                            .on('keyup change', function () {#}
{#                                if (column.search() !== this.value) {#}
{#                                    column.search(this.value).draw();#}
{#                                }#}
{#                            });#}
{#                    });#}
{#                }#}
{#            });#}
{#        });#}
{#    </script>#}
{#</body>#}
{#</html>#}
{#{% extends "layout.html" %}#}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xuất báo cáo PDF</title>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .export-button {
            display: inline-block;
            padding: 12px 24px;
            background-color: #4CAF50;
            color: white !important;
            text-decoration: none;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .export-button:hover {
            background-color: #45a049;
            text-decoration: none;
        }
        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .status-positive {
            background-color: #ffebee;
            color: #c62828;
        }
        .status-negative {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        .dt-buttons {
            margin-bottom: 15px;
        }
        .dataTables_filter {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Dữ liệu bệnh nhân</h1>
            <a href="{{ url_for('test_export_pdf') }}" class="export-button">
                Tải xuống PDF
            </a>
        </div>

        <!-- Hiển thị thông số đánh giá mô hình -->
        <div class="row mb-5">
            <div class="col-md-6">
                <h4>Đánh giá mô hình</h4>
                <p><strong>Độ chính xác (Accuracy):</strong> {{ accuracy }}</p>
                <p><strong>Precision:</strong> {{ precision }}</p>
                <p><strong>Recall:</strong> {{ recall }}</p>
                <p><strong>F1-Score:</strong> {{ f1 }}</p>
            </div>

            <div class="col-md-6">
                <h4>Ma trận nhầm lẫn</h4>
                <div>{{ cm | safe }}</div>
            </div>
        </div>

        <div class="table-responsive">
            <table id="patientTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tuổi</th>
                        <th>Giới tính</th>
                        <th>Loại đau ngực</th>
                        <th>Huyết áp</th>
                        <th>Cholesterol</th>
                        <th>Nhịp tim tối đa</th>
                        <th>Đau thắt ngực</th>
                        <th>Đường huyết</th>
                        <th>Chẩn đoán</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        <td>{{ row[0] }}</td>
                        <td>{{ row[1] }}</td>
                        <td>{{ row[2] }}</td>
                        <td>{{ row[3] }}</td>
                        <td>{{ row[4] }}</td>
                        <td>{{ row[5] }}</td>
                        <td>{{ row[6] }}</td>
                        <td>{{ row[7] }}</td>
                        <td>{{ row[8] }}</td>
                        <td>
                            <span class="status {% if 'Có bệnh' in row[9] %}status-positive{% else %}status-negative{% endif %}">
                                {{ row[9] }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>

    <script>
        $(document).ready(function() {
            $('#patientTable').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'csv', 'excel', 'print'
                ],
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/vi.json'
                },
                pageLength: 10,
                lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "Tất cả"]],
                order: [[0, 'asc']],
                responsive: true,
                initComplete: function () {
                    // Thêm bộ lọc cho các cột
                    this.api().columns().every(function () {
                        var column = this;
                        var title = column.header().textContent;

                        // Tạo input cho tìm kiếm
                        var input = $('<input type="text" class="form-control form-control-sm" placeholder="Tìm ' + title + '" />')
                            .appendTo($(column.header()))
                            .on('keyup change', function () {
                                if (column.search() !== this.value) {
                                    column.search(this.value).draw();
                                }
                            });
                    });
                }
            });
        });
    </script>
</body>
</html>
