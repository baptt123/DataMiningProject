{% extends "layout.html" %}
{% block title %}Dự Đoán Nguy Cơ Bệnh Tim{% endblock %}

{% block body %}
<div class="heart-prediction-container">
    <div class="background-overlay"></div>

    <div class="container">
        <div class="prediction-wrapper">
            <div class="prediction-header text-center">
                <h1 class="display-4 text-primary">
                    <i class="fas fa-heartbeat"></i> Đánh Giá Nguy Cơ Bệnh Tim
                </h1>
                <p class="lead text-muted">
                    Nhập thông tin chi tiết để được đánh giá sức khỏe tim mạch
                </p>
            </div>

            <form action="{{ url_for('predict_heart') }}"
                  method="post"
                  class="prediction-form"
                  onsubmit="return validateForm()">

                <div class="row">
                    <!-- Cột trái -->
                    <div class="col-md-6">
                        <!-- Tuổi -->
                        <div class="form-group mb-3">
                            <label class="form-label">Tuổi</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-birthday-cake"></i></span>
                                <input type="number"
                                       name="age"
                                       id="age"
                                       class="form-control"
                                       placeholder="Nhập tuổi"
                                       min="20"
                                       max="80"
                                       required>
                            </div>
                        </div>

                        <!-- Giới tính -->
                        <div class="form-group mb-3">
                            <label class="form-label">Giới Tính</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-venus-mars"></i></span>
                                <select name="sex"
                                        class="form-control"
                                        required>
                                    <option value="1">Nam</option>
                                    <option value="0">Nữ</option>
                                </select>
                            </div>
                        </div>

                        <!-- Loại Đau Ngực -->
                        <div class="form-group mb-3">
                            <label class="form-label">Loại Đau Ngực</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-notes-medical"></i></span>
                                <select name="chest_pain_type"
                                        class="form-control"
                                        required>
                                    <option value="1">Đau kiểu 1</option>
                                    <option value="2">Đau kiểu 2</option>
                                    <option value="3">Đau kiểu 3</option>
                                    <option value="4">Đau kiểu 4</option>
                                </select>
                            </div>
                        </div>

                        <!-- Đường Huyết Cao -->
                        <div class="form-group mb-3">
                            <label class="form-label">Đường Huyết Cao</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-sugar-cube"></i></span>
                                <select name="fasting_blood_sugar"
                                        class="form-control"
                                        required>
                                    <option value="1">Có</option>
                                    <option value="0">Không</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Cột phải -->
                    <div class="col-md-6">
                        <!-- Huyết Áp -->
                        <div class="form-group mb-3">
                            <label class="form-label">Huyết Áp (mmHg)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-tachometer-alt"></i></span>
                                <input type="number"
                                       name="resting_bp"
                                       id="resting_bp"
                                       class="form-control"
                                       placeholder="Nhập huyết áp"
                                       min="90"
                                       max="200"
                                       required>
                            </div>
                        </div>

                        <!-- Cholesterol -->
                        <div class="form-group mb-3">
                            <label class="form-label">Cholesterol (mg/dL)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                <input type="number"
                                       name="cholesterol"
                                       id="cholesterol"
                                       class="form-control"
                                       placeholder="Nhập cholesterol"
                                       min="120"
                                       max="400"
                                       required>
                            </div>
                        </div>

                        <!-- Nhịp Tim Lúc Nghỉ -->
                        <div class="form-group mb-3">
                            <label class="form-label">Nhịp Tim Lúc Nghỉ</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-heartbeat"></i></span>
                                <input type="number"
                                       name="resting_ecg"
                                       id="resting_ecg"
                                       class="form-control"
                                       placeholder="Nhập nhịp tim"
                                       required>
                            </div>
                        </div>

                        <!-- Đau Thắt Ngực Khi Gắng Sức -->
                        <div class="form-group mb-3">
                            <label class="form-label">Đau Thắt Ngực Khi Gắng Sức</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-running"></i></span>
                                <select name="exercise_angina"
                                        class="form-control"
                                        required>
                                    <option value="1">Có</option>
                                    <option value="0">Không</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hàng cuối -->
                <div class="row">
                    <div class="col-md-6">
                        <!-- Nhịp Tim Tối Đa -->
                        <div class="form-group mb-3">
                            <label class="form-label">Nhịp Tim Tối Đa</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-heartbeat"></i></span>
                                <input type="number"
                                       name="max_hr"
                                       id="max_hr"
                                       class="form-control"
                                       placeholder="Nhập nhịp tim tối đa"
                                       min="60"
                                       max="220"
                                       required>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <!-- Độ Dốc ST -->
                        <div class="form-group mb-3">
                            <label class="form-label">Độ Dốc ST</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-chart-area"></i></span>
                                <input type="number"
                                       name="oldpeak"
                                       id="oldpeak"
                                       class="form-control"
                                       placeholder="Nhập độ dốc ST"
                                       step="0.1"
                                       required>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Nút Submit -->
                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-primary btn-lg px-5">
                        <i class="fas fa-diagnoses me-2"></i>Kiểm Tra Nguy Cơ
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    .heart-prediction-container {
        position: relative;
        min-height: 100vh;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        display: flex;
        align-items: center;
        padding: 50px 0;
    }

    .background-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255,255,255,0.7);
        z-index: 1;
    }

    .prediction-wrapper {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        padding: 40px;
        position: relative;
        z-index: 2;
    }

    .prediction-header {
        margin-bottom: 30px;
    }

    .input-group-text {
        background-color: #f8f9fa;
    }
</style>

<script>
    function validateForm() {
        // Tuổi
        var age = document.getElementById("age");
        if (age.value < 20 || age.value > 80) {
            alert("⚠️ Tuổi phải từ 20-80 tuổi!");
            age.focus();
            return false;
        }

        // Huyết áp
        var restingBloodPressure = document.getElementById("resting_bp");
        if (restingBloodPressure.value < 90 || restingBloodPressure.value > 200) {
            alert("⚠️ Huyết áp phải từ 90-200 mmHg!");
            restingBloodPressure.focus();
            return false;
        }

        // Cholesterol
        var cholesterol = document.getElementById("cholesterol");
        if (cholesterol.value < 120 || cholesterol.value > 400) {
            alert("⚠️ Cholesterol phải từ 120-400 mg/dL!");
            cholesterol.focus();
            return false;
        }

        return true;
    }
</script>

{% endblock %}
